<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        /* ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        .login-container {
            max-width: 450px;
            margin: 50px auto;
            padding: 40px;
        }
        
        .login-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .login-box h2 {
            color: #667eea;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 100%;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #000;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        /* ØµÙØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ */
        .admin-content {
            padding: 30px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .search-box {
            flex: 1;
            min-width: 200px;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-card h3 {
            font-size: 32px;
            margin-bottom: 5px;
        }
        
        .stat-card p {
            opacity: 0.9;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid #e0e0e0;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .action-buttons .btn {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        /* ØµÙØ­Ø© Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· */
        .member-content {
            padding: 30px;
        }
        
        .form-container {
            max-width: 800px;
            margin: 0 auto;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }
        
        .hidden {
            display: none;
        }
        
        .user-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .user-info span {
            font-weight: 600;
            color: #667eea;
        }

        .rating-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .rating-excellent { background: #28a745; color: white; }
        .rating-very-good { background: #17a2b8; color: white; }
        .rating-good { background: #ffc107; color: black; }
        .rating-average { background: #fd7e14; color: white; }

        .input-hint {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }

        .export-loading {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
        }

        .export-options {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <!-- ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <h2>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            
            <div class="form-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <input type="text" id="loginUsername" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            </div>
            <div class="form-group">
                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input type="password" id="loginPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            </div>
            <div class="form-group">
                <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <select id="loginUserType">
                    <option value="member">Ø¹Ø¶Ùˆ Ø§Ø±ØªØ¨Ø§Ø·</option>
                    <option value="admin">Ù…Ø³Ø¤ÙˆÙ„</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
            <div id="loginError" class="error-message hidden" style="margin-top: 15px;"></div>
        </div>
    </div>

    <!-- ØµÙØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ -->
    <div id="adminPage" class="container hidden">
        <div class="header">
            <h1>ğŸ“Š Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h1>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©</p>
        </div>
        
        <div class="admin-content">
            <div class="user-info">
                <span id="adminWelcome">Ù…Ø±Ø­Ø¨Ø§Ù‹: Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</span>
                <button class="btn btn-secondary" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <h3 id="totalRecords">0</h3>
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</p>
                </div>
                <div class="stat-card">
                    <h3 id="todayRecords">0</h3>
                    <p>Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…</p>
                </div>
                <div class="stat-card">
                    <h3 id="excellentCount">0</h3>
                    <p>ØªÙ‚ÙŠÙŠÙ… Ù…Ù…ØªØ§Ø²</p>
                </div>
                <div class="stat-card">
                    <h3 id="professorsCount">0</h3>
                    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©</p>
                </div>
            </div>

            <div class="export-options">
                <h4>ğŸ“¥ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØµØ¯ÙŠØ±</h4>
                <p>Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©:</p>
                <button class="btn btn-success" onclick="exportToCSV()">ğŸ“Š ØªØµØ¯ÙŠØ± CSV (Ù…Ø³ØªØ­Ø³Ù†)</button>
                <button class="btn btn-warning" onclick="exportToExcel()">ğŸ“ˆ ØªØµØ¯ÙŠØ± Excel</button>
                <button class="btn btn-primary" onclick="showExportHelp()">â„¹ï¸ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„ØªØµØ¯ÙŠØ±</button>
            </div>
            
            <div class="controls">
                <input type="text" id="searchInput" class="search-box" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„...">
                <button class="btn btn-primary" onclick="searchData()">ğŸ” Ø¨Ø­Ø«</button>
                <button class="btn btn-warning" onclick="addSampleData()">â• Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
                <button class="btn btn-danger" onclick="deleteAllData()">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙƒÙ„</button>
            </div>

            <div id="exportLoading" class="export-loading hidden">
                â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù…Ù„Ù Ù„Ù„ØªØµØ¯ÙŠØ±...
            </div>
            
            <div id="dataTable"></div>
        </div>
    </div>

    <!-- ØµÙØ­Ø© Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· -->
    <div id="memberPage" class="container hidden">
        <div class="header">
            <h1>ğŸ“ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©</h1>
            <p>Ù†Ù…ÙˆØ°Ø¬ Ø±ÙØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
        </div>
        
        <div class="member-content">
            <div class="user-info">
                <span id="memberName">Ù…Ø±Ø­Ø¨Ø§Ù‹: Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·</span>
                <button class="btn btn-secondary" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
            
            <div id="successMsg" class="success-message hidden"></div>
            
            <div class="form-container">
                <form id="dataForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ <span style="color: red;">*</span></label>
                            <input type="text" id="fullName" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ Ø§Ù„ÙƒØ§Ù…Ù„">
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„ÙƒÙ„ÙŠØ© <span style="color: red;">*</span></label>
                            <input type="text" id="college" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ÙƒÙ„ÙŠØ©">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ø§Ù„Ù‚Ø³Ù… <span style="color: red;">*</span></label>
                            <input type="text" id="department" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…">
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© <span style="color: red;">*</span></label>
                            <input type="text" id="certificate" required placeholder="Ù…Ø«Ø§Ù„: Ø¨ÙƒØ§Ù„ÙˆØ±ÙŠÙˆØ³ØŒ Ù…Ø§Ø¬Ø³ØªÙŠØ±ØŒ Ø¯ÙƒØªÙˆØ±Ø§Ù‡">
                            <div class="input-hint">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ© Ø§Ù„ØªÙŠ Ø­ØµÙ„ Ø¹Ù„ÙŠÙ‡Ø§</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ø§Ù„Ù„Ù‚Ø¨ Ø§Ù„Ø¹Ù„Ù…ÙŠ <span style="color: red;">*</span></label>
                            <input type="text" id="academicTitle" required placeholder="Ù…Ø«Ø§Ù„: Ù…Ø¯Ø±Ø³ØŒ Ø£Ø³ØªØ§Ø° Ù…Ø³Ø§Ø¹Ø¯ØŒ Ø£Ø³ØªØ§Ø°">
                            <div class="input-hint">Ø£Ø¯Ø®Ù„ Ø§Ù„Ù„Ù‚Ø¨ Ø§Ù„Ø¹Ù„Ù…ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø¹Ø§Ù… <span style="color: red;">*</span></label>
                            <input type="text" id="generalSpecialty" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø¹Ø§Ù…">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø¯Ù‚ÙŠÙ‚</label>
                            <input type="text" id="detailedSpecialty" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ (Ø¥Ù† ÙˆØ¬Ø¯)">
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„ØªØ´ÙƒÙŠÙ„</label>
                            <input type="text" id="formation" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ØªØ´ÙƒÙŠÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… <span style="color: red;">*</span></label>
                            <input type="text" id="rating" required placeholder="Ù…Ø«Ø§Ù„: Ù…Ù…ØªØ§Ø²ØŒ Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹ØŒ Ø¬ÙŠØ¯">
                            <div class="input-hint">Ø£Ø¯Ø®Ù„ Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ø§Ù…</div>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠ <span style="color: red;">*</span></label>
                            <input type="email" id="email" required placeholder="example@ntu.edu.iq">
                        </div>
                    </div>
                    
                    <button type="button" class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="submitData()">
                        âœ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© - Ø§Ø³ØªØ®Ø¯Ø§Ù… localStorage Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† sessionStorage
        let academicData = JSON.parse(localStorage.getItem('academicData')) || [];
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        
        // Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (Ø¨Ø¯ÙˆÙ† Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©)
        const users = {
            admin: { username: 'admin', password: 'admin123', type: 'admin', name: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„' },
            member1: { username: 'member1', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 1' },
            member2: { username: 'member2', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 2' },
            member3: { username: 'member3', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 3' },
            member4: { username: 'member4', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 4' },
            member5: { username: 'member5', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 5' },
            member6: { username: 'member6', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 6' },
            member7: { username: 'member7', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 7' },
            member8: { username: 'member8', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 8' },
            member9: { username: 'member9', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 9' },
            member10: { username: 'member10', password: 'member123', type: 'member', name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· 10' }
        };
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØµÙØ­Ø©
        window.onload = function() {
            checkLogin();
        };
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function checkLogin() {
            if (currentUser) {
                showPage(currentUser.type);
            } else {
                showPage('login');
            }
        }
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            const userType = document.getElementById('loginUserType').value;
            const errorDiv = document.getElementById('loginError');
            
            let user = null;
            for (let key in users) {
                if (users[key].username === username && 
                    users[key].password === password && 
                    users[key].type === userType) {
                    user = users[key];
                    break;
                }
            }
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                errorDiv.classList.add('hidden');
                showPage(user.type);
            } else {
                errorDiv.textContent = 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
                errorDiv.classList.remove('hidden');
            }
        }
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        function logout() {
            localStorage.removeItem('currentUser');
            currentUser = null;
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
            showPage('login');
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
        function showPage(type) {
            document.getElementById('loginPage').classList.add('hidden');
            document.getElementById('adminPage').classList.add('hidden');
            document.getElementById('memberPage').classList.add('hidden');
            
            if (type === 'login') {
                document.getElementById('loginPage').classList.remove('hidden');
            } else if (type === 'admin') {
                document.getElementById('adminPage').classList.remove('hidden');
                document.getElementById('adminWelcome').textContent = 'Ù…Ø±Ø­Ø¨Ø§Ù‹: ' + currentUser.name;
                displayData();
                updateStats();
            } else if (type === 'member') {
                document.getElementById('memberPage').classList.remove('hidden');
                document.getElementById('memberName').textContent = 'Ù…Ø±Ø­Ø¨Ø§Ù‹: ' + currentUser.name;
            }
        }
        
        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·)
        function submitData() {
            const fullName = document.getElementById('fullName').value;
            const college = document.getElementById('college').value;
            const department = document.getElementById('department').value;
            const certificate = document.getElementById('certificate').value;
            const academicTitle = document.getElementById('academicTitle').value;
            const generalSpecialty = document.getElementById('generalSpecialty').value;
            const detailedSpecialty = document.getElementById('detailedSpecialty').value;
            const formation = document.getElementById('formation').value;
            const rating = document.getElementById('rating').value;
            const email = document.getElementById('email').value;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            if (!fullName || !college || !department || !certificate || !academicTitle || !generalSpecialty || !rating || !email) {
                alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                return;
            }
            
            const newRecord = {
                id: Date.now(),
                fullName: fullName,
                college: college,
                department: department,
                certificate: certificate,
                academicTitle: academicTitle,
                generalSpecialty: generalSpecialty,
                detailedSpecialty: detailedSpecialty,
                formation: formation,
                rating: rating,
                email: email,
                submittedBy: currentUser.name,
                submittedAt: new Date().toISOString()
            };
            
            academicData.push(newRecord);
            localStorage.setItem('academicData', JSON.stringify(academicData));
            
            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
            const successMsg = document.getElementById('successMsg');
            successMsg.textContent = 'âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!';
            successMsg.classList.remove('hidden');
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            document.getElementById('dataForm').reset();
            
            // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
                successMsg.classList.add('hidden');
            }, 3000);
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„)
        function displayData(data = academicData) {
            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ</th>
                            <th>Ø§Ù„ÙƒÙ„ÙŠØ©</th>
                            <th>Ø§Ù„Ù‚Ø³Ù…</th>
                            <th>Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©</th>
                            <th>Ø§Ù„Ù„Ù‚Ø¨ Ø§Ù„Ø¹Ù„Ù…ÙŠ</th>
                            <th>Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø¹Ø§Ù…</th>
                            <th>Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                            <th>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</th>
                            <th>Ø£Ø¯Ø®Ù„ Ø¨ÙˆØ§Ø³Ø·Ø©</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            if (data.length === 0) {
                tableHTML += `
                    <tr>
                        <td colspan="10" style="text-align: center; padding: 30px; color: #999;">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§
                        </td>
                    </tr>
                `;
            } else {
                data.forEach(record => {
                    const ratingClass = getRatingClass(record.rating);
                    tableHTML += `
                        <tr>
                            <td><strong>${record.fullName}</strong></td>
                            <td>${record.college}</td>
                            <td>${record.department}</td>
                            <td>${record.certificate}</td>
                            <td>${record.academicTitle}</td>
                            <td>${record.generalSpecialty}</td>
                            <td><span class="rating-badge ${ratingClass}">${record.rating}</span></td>
                            <td>${record.email}</td>
                            <td>${record.submittedBy || '-'}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn btn-warning" onclick="editRecord(${record.id})">ØªØ¹Ø¯ÙŠÙ„</button>
                                    <button class="btn btn-danger" onclick="deleteRecord(${record.id})">Ø­Ø°Ù</button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
            }
            
            tableHTML += `</tbody></table>`;
            document.getElementById('dataTable').innerHTML = tableHTML;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„Ø§Ø³ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
        function getRatingClass(rating) {
            const ratingLower = rating.toLowerCase();
            if (ratingLower.includes('Ù…Ù…ØªØ§Ø²')) return 'rating-excellent';
            if (ratingLower.includes('Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹') || ratingLower.includes('Ø¬ÙŠØ¯ Ø¬Ø¯Ø§')) return 'rating-very-good';
            if (ratingLower.includes('Ø¬ÙŠØ¯')) return 'rating-good';
            if (ratingLower.includes('Ù…ØªÙˆØ³Ø·')) return 'rating-average';
            return '';
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            document.getElementById('totalRecords').textContent = academicData.length;
            
            const today = new Date().toDateString();
            const todayCount = academicData.filter(r => {
                if (!r.submittedAt) return false;
                const recordDate = new Date(r.submittedAt).toDateString();
                return recordDate === today;
            }).length;
            document.getElementById('todayRecords').textContent = todayCount;

            // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¥Ø¶Ø§ÙÙŠØ©
            const excellentCount = academicData.filter(r => 
                r.rating.toLowerCase().includes('Ù…Ù…ØªØ§Ø²')).length;
            document.getElementById('excellentCount').textContent = excellentCount;

            const professorsCount = academicData.filter(r => 
                r.academicTitle.toLowerCase().includes('Ø£Ø³ØªØ§Ø°')).length;
            document.getElementById('professorsCount').textContent = professorsCount;
        }
        
        // Ø§Ù„Ø¨Ø­Ø«
        function searchData() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filteredData = academicData.filter(record => 
                record.fullName.toLowerCase().includes(searchTerm) ||
                record.email.toLowerCase().includes(searchTerm) ||
                record.college.toLowerCase().includes(searchTerm) ||
                record.department.toLowerCase().includes(searchTerm) ||
                record.certificate.toLowerCase().includes(searchTerm) ||
                record.academicTitle.toLowerCase().includes(searchTerm)
            );
            displayData(filteredData);
        }
        
        // Ø­Ø°Ù Ø³Ø¬Ù„
        function deleteRecord(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„ØŸ')) {
                academicData = academicData.filter(record => record.id !== id);
                localStorage.setItem('academicData', JSON.stringify(academicData));
                displayData();
                updateStats();
                alert('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„ Ø¨Ù†Ø¬Ø§Ø­');
            }
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¬Ù„
        function editRecord(id) {
            const record = academicData.find(r => r.id === id);
            if (record) {
                const newName = prompt('Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ:', record.fullName);
                const newEmail = prompt('Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:', record.email);
                const newCertificate = prompt('Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©:', record.certificate);
                const newAcademicTitle = prompt('Ø§Ù„Ù„Ù‚Ø¨ Ø§Ù„Ø¹Ù„Ù…ÙŠ:', record.academicTitle);
                const newRating = prompt('Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:', record.rating);
                
                if (newName !== null) {
                    record.fullName = newName;
                    record.email = newEmail || record.email;
                    record.certificate = newCertificate || record.certificate;
                    record.academicTitle = newAcademicTitle || record.academicTitle;
                    record.rating = newRating || record.rating;
                    
                    localStorage.setItem('academicData', JSON.stringify(academicData));
                    displayData();
                    alert('âœ… ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„ Ø¨Ù†Ø¬Ø§Ø­');
                }
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
        function addSampleData() {
            const sampleData = [
                {
                    id: Date.now() + 1,
                    fullName: "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ",
                    college: "ÙƒÙ„ÙŠØ© Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©",
                    department: "Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨",
                    certificate: "Ø¯ÙƒØªÙˆØ±Ø§Ù‡",
                    academicTitle: "Ø£Ø³ØªØ§Ø°",
                    generalSpecialty: "Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª",
                    detailedSpecialty: "Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",
                    formation: "Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹Ø§Ù„ÙŠ",
                    rating: "Ù…Ù…ØªØ§Ø²",
                    email: "ahmed@ntu.edu.iq",
                    submittedBy: "Ø§Ù„Ù†Ø¸Ø§Ù…",
                    submittedAt: new Date().toISOString()
                },
                {
                    id: Date.now() + 2,
                    fullName: "ÙØ§Ø·Ù…Ø© Ø­Ø³Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡",
                    college: "ÙƒÙ„ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ…",
                    department: "Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³ÙˆØ¨",
                    certificate: "Ù…Ø§Ø¬Ø³ØªÙŠØ±",
                    academicTitle: "Ø£Ø³ØªØ§Ø° Ù…Ø³Ø§Ø¹Ø¯",
                    generalSpecialty: "Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ",
                    detailedSpecialty: "ØªØ¹Ù„Ù… Ø§Ù„Ø¢Ù„Ø©",
                    formation: "Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¹Ù„Ù…ÙŠ",
                    rating: "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹",
                    email: "fatima@ntu.edu.iq",
                    submittedBy: "Ø§Ù„Ù†Ø¸Ø§Ù…",
                    submittedAt: new Date().toISOString()
                }
            ];

            academicData = [...academicData, ...sampleData];
            localStorage.setItem('academicData', JSON.stringify(academicData));
            displayData();
            updateStats();
            alert('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
        }
        
        // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function deleteAllData() {
            if (confirm('âš ï¸ ØªØ­Ø°ÙŠØ±: Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!')) {
                if (confirm('ØªØ£ÙƒÙŠØ¯ Ù†Ù‡Ø§Ø¦ÙŠ: Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹!')) {
                    academicData = [];
                    localStorage.setItem('academicData', JSON.stringify(academicData));
                    displayData();
                    updateStats();
                    alert('âœ… ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                }
            }
        }

        // ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ CSV - Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø¶Ù…ÙˆÙ†Ø©
        function exportToCSV() {
            if (academicData.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±');
                return;
            }

            const loadingDiv = document.getElementById('exportLoading');
            loadingDiv.classList.remove('hidden');

            setTimeout(() => {
                try {
                    // Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
                    const headers = [
                        'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ',
                        'Ø§Ù„ÙƒÙ„ÙŠØ©', 
                        'Ø§Ù„Ù‚Ø³Ù…',
                        'Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©',
                        'Ø§Ù„Ù„Ù‚Ø¨ Ø§Ù„Ø¹Ù„Ù…ÙŠ',
                        'Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø¹Ø§Ù…',
                        'Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø¯Ù‚ÙŠÙ‚',
                        'Ø§Ù„ØªØ´ÙƒÙŠÙ„',
                        'Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…',
                        'Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„',
                        'Ø£Ø¯Ø®Ù„ Ø¨ÙˆØ§Ø³Ø·Ø©',
                        'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„'
                    ];

                    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ CSV
                    let csvContent = '';
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
                    csvContent += headers.join(';') + '\n';
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    academicData.forEach(record => {
                        const row = [
                            cleanForCSV(record.fullName),
                            cleanForCSV(record.college),
                            cleanForCSV(record.department),
                            cleanForCSV(record.certificate),
                            cleanForCSV(record.academicTitle),
                            cleanForCSV(record.generalSpecialty),
                            cleanForCSV(record.detailedSpecialty || ''),
                            cleanForCSV(record.formation || ''),
                            cleanForCSV(record.rating),
                            cleanForCSV(record.email),
                            cleanForCSV(record.submittedBy || ''),
                            record.submittedAt ? new Date(record.submittedAt).toLocaleDateString('ar-IQ') : ''
                        ];
                        csvContent += row.join(';') + '\n';
                    });

                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙØ§ØµÙ„Ø© Ø§Ù„Ù…Ù†Ù‚ÙˆØ·Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„ÙØ§ØµÙ„Ø© Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Excel Ø§Ù„Ø¹Ø±Ø¨ÙŠ
                    const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
                    const link = document.createElement('a');
                    const url = URL.createObjectURL(blob);
                    link.href = url;
                    
                    const today = new Date().toISOString().split('T')[0];
                    link.download = `academic_data_${today}.csv`;
                    
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    
                    loadingDiv.classList.add('hidden');
                    alert('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­! Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙØ§ØµÙ„Ø© Ø§Ù„Ù…Ù†Ù‚ÙˆØ·Ø© (;) ÙƒÙØ§ØµÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙÙŠ Excel.');
                    
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±:', error);
                    loadingDiv.classList.add('hidden');
                    alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØµØ¯ÙŠØ±: ' + error.message);
                }
            }, 500);
        }

        // ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© SheetJS
        function exportToExcel() {
            if (academicData.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±');
                return;
            }

            const loadingDiv = document.getElementById('exportLoading');
            loadingDiv.classList.remove('hidden');

            setTimeout(() => {
                try {
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Excel ÙŠØ¯ÙˆÙŠØ§Ù‹
                    let excelContent = 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ\tØ§Ù„ÙƒÙ„ÙŠØ©\tØ§Ù„Ù‚Ø³Ù…\tØ§Ù„Ø´Ù‡Ø§Ø¯Ø©\tØ§Ù„Ù„Ù‚Ø¨ Ø§Ù„Ø¹Ù„Ù…ÙŠ\tØ§Ù„ØªØ®ØµØµ Ø§Ù„Ø¹Ø§Ù…\tØ§Ù„ØªØ®ØµØµ Ø§Ù„Ø¯Ù‚ÙŠÙ‚\tØ§Ù„ØªØ´ÙƒÙŠÙ„\tØ¯Ø±Ø¬Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…\tØ§Ù„Ø¥ÙŠÙ…ÙŠÙ„\tØ£Ø¯Ø®Ù„ Ø¨ÙˆØ§Ø³Ø·Ø©\tØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„\n';
                    
                    academicData.forEach(record => {
                        excelContent += 
                            (record.fullName || '') + '\t' +
                            (record.college || '') + '\t' +
                            (record.department || '') + '\t' +
                            (record.certificate || '') + '\t' +
                            (record.academicTitle || '') + '\t' +
                            (record.generalSpecialty || '') + '\t' +
                            (record.detailedSpecialty || '') + '\t' +
                            (record.formation || '') + '\t' +
                            (record.rating || '') + '\t' +
                            (record.email || '') + '\t' +
                            (record.submittedBy || '') + '\t' +
                            (record.submittedAt ? new Date(record.submittedAt).toLocaleDateString('ar-IQ') : '') + '\n';
                    });

                    const blob = new Blob(['\uFEFF' + excelContent], { type: 'text/plain;charset=utf-8' });
                    const link = document.createElement('a');
                    const url = URL.createObjectURL(blob);
                    link.href = url;
                    
                    const today = new Date().toISOString().split('T')[0];
                    link.download = `academic_data_${today}.xls`;
                    
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    
                    loadingDiv.classList.add('hidden');
                    alert('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­! Ø§ÙØªØ­ Ø§Ù„Ù…Ù„Ù ÙÙŠ Excel.');
                    
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±:', error);
                    loadingDiv.classList.add('hidden');
                    alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØµØ¯ÙŠØ±. Ø¬Ø±Ø¨ ØªØµØ¯ÙŠØ± CSV Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„Ùƒ.');
                }
            }, 500);
        }

        // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±
        function cleanForCSV(text) {
            if (!text) return '';
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙÙˆØ§ØµÙ„ ÙˆØ§Ù„ÙÙˆØ§ØµÙ„ Ø§Ù„Ù…Ù†Ù‚ÙˆØ·Ø© Ø§Ù„ØªÙŠ Ù‚Ø¯ ØªØ³Ø¨Ø¨ Ù…Ø´Ø§ÙƒÙ„
            return String(text).replace(/[,;]/g, ' ').replace(/\n/g, ' ').replace(/\r/g, ' ').trim();
        }

        // Ø¹Ø±Ø¶ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„ØªØµØ¯ÙŠØ±
        function showExportHelp() {
            alert(`ğŸ’¡ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„ØªØµØ¯ÙŠØ±:

1. ğŸ“Š ØªØµØ¯ÙŠØ± CSV (Ù…Ø³ØªØ­Ø³Ù†):
   - ÙŠÙ†Ø´Ø¦ Ù…Ù„Ù CSV ÙŠÙ…ÙƒÙ† ÙØªØ­Ù‡ ÙÙŠ Excel
   - Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙØ§ØµÙ„Ø© Ø§Ù„Ù…Ù†Ù‚ÙˆØ·Ø© (;) ÙƒÙØ§ØµÙ„
   - ÙŠØ¯Ø¹Ù… Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„

2. ğŸ“ˆ ØªØµØ¯ÙŠØ± Excel:
   - ÙŠÙ†Ø´Ø¦ Ù…Ù„Ù Excel Ù…Ø¨Ø§Ø´Ø±Ø©
   - Ù‚Ø¯ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„ØºØ©

3. Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¸Ù‡Ø± ÙÙŠ Ø¹Ù…ÙˆØ¯ ÙˆØ§Ø­Ø¯:
   - ÙÙŠ Excel: Ø¨ÙŠØ§Ù†Ø§Øª â†’ Ù†Øµ Ø¥Ù„Ù‰ Ø£Ø¹Ù…Ø¯Ø© â†’ Ø§Ø®ØªØ± Ø§Ù„ÙØ§ØµÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
   - Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙØ§ØµÙ„Ø© Ø§Ù„Ù…Ù†Ù‚ÙˆØ·Ø© (;) ÙƒÙØ§ØµÙ„
            `);
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„ÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
        if (academicData.length === 0) {
            addSampleData();
        }
    </script>
</body>
</html>